# defer について

## defer の処理順序

あとから登録したものほど先に実行される。LIFO。

> このような設計になっているのは、defer が何かしらの「後処理」に使われることが多いため。
> 複数のリソースを開いた場合、後から開いたものを先に閉じるようにするのが自然ではある。

AI からはこういった回答だったけど…これは後付けのような気がする？
「defer が入れ子になっているとき、スタックを利用するほうが都合が良い」という回答もあり、こちらのほうが自然に感じられる。

入れ子になっていようがいまいが、スタックを用いて管理されるから自然と LIFO になる、と覚えておきたい。

`defer f()` で `f` を予約した、みたいなイメージだったが、スタックに積んだ、という風に考えたほうが色々と合点がいくことが多そう。
